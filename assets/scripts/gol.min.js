"use strict";$(document).ready(function(){var g=1,o=0,a=u(200,200,o),h=3,v=document.querySelector("#myCanvas");v.width=a.length*h,v.height=a[0].length*h;var e,f=v.getContext("2d"),s=document.querySelector("#color1"),m=document.querySelector("#color2");function t(){r(a=function(e){for(var t=u(e.length,e[0].length,o),n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]===g?c(e,n,r)<2?t[n][r]=o:2===c(e,n,r)||3===c(e,n,r)?t[n][r]=g:3<c(e,n,r)&&(t[n][r]=o):a[n][r]===o&&3===c(e,n,r)&&(t[n][r]=g);return t}(a)),e=window.requestAnimationFrame(t)}function n(e){for(var t=Math.round(e.length/2),n=Math.round(e[0].length/2),r=[[0,0],[-3,-1],[-2,-1],[-2,1],[1,-1],[2,-1],[3,-1]],o=0;o<r.length;o++){var a=r[o][0],c=r[o][1];e[t+a][n+c]=g}}function c(e,t,n){for(var r=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]],o=0,a=0;a<8;a++){var c=r[a][0],u=r[a][1];e[i(t+c,e.length)][i(n+u,e[t].length)]===g&&o++}return o}function i(e,t){return t<=e&&(e-=t),e<0&&(e+=t),e}function r(e){for(var t=f.getImageData(0,0,e.length*h,e[0].length*h),n=p(s.value),r=p(m.value),o=0;o<e.length;o++)for(var a=0;a<e[0].length;a++)for(var c=e[o][a]===g,u=0;u<h;u++)for(var i=0;i<h;i++){var d=4*(o*h+u+(a*h+i)*e.length*h);t.data[d+0]=c?n.r:r.r,t.data[d+1]=c?n.g:r.g,t.data[d+2]=c?n.b:r.b,t.data[d+3]=255}f.putImageData(t,0,0);var l=v.toDataURL("image/png");$("#divImg").empty(),$("#divImg").append("<img src='"+l+"'>")}function p(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function u(e,t,n){for(var r=[],o=0;o<e;o++)r[o]=[];for(o=0;o<e;o++)for(var a=0;a<t;a++)r[o][a]=n;return r}n(a),r(a),$("#stop").hide(),document.querySelector("#start").addEventListener("click",function(){e||(e=window.requestAnimationFrame(t),$("#start").hide(),$("#stop").show())}),document.querySelector("#stop").addEventListener("click",function(){window.cancelAnimationFrame(e),e=void 0,$("#start").show(),$("#stop").hide()}),document.querySelector("#acorn").addEventListener("click",function(){n(a=u(a.length,a[0].length,o)),r(a)}),document.querySelector("#cross").addEventListener("click",function(){(function(e){for(var t=e.length,n=e[0].length,r=0;r<t;r++){var o=r;0<=o&&o<n&&(e[r][o]=g)}for(var r=t-1;0<=r;r--){var o=n-(r+1);0<=o&&o<n&&(e[r][o]=g)}})(a=u(a.length,a[0].length,o)),r(a)}),document.querySelector("#color1").addEventListener("change",function(){r(a)}),document.querySelector("#color2").addEventListener("change",function(){r(a)})});