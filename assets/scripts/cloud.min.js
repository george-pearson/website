"use strict";!function(){var y,t=Math.pow(2,9)+1,f=document.querySelector("#color1"),u=document.querySelector("#color2"),a=document.querySelector("#reload");function e(t){(y=function(t,a){for(var e=[],r=0;r<t;r++)e[r]=[];for(var r=0;r<t;r++)for(var n=0;n<a;n++)e[r][n]=0;return e}(t,t))[0][0]=2*Math.random()-1,y[0][t-1]=2*Math.random()-1,y[t-1][0]=2*Math.random()-1,y[t-1][t-1]=2*Math.random()-1;for(var a=t-1,e=1,r=1;1<a;){for(var n,o,i,l,c,d,g,f,u,v,h,m=Math.round(a/2),s=[[-1,0],[1,0],[0,-1],[0,1]],p=0;p<e;p++)for(var M=0;M<e;M++)o=(p+1)*a,l=(M+1)*a,d=(i=M*a)+m,y[c=(n=p*a)+m][d]=(y[i][n]+y[i][o]+y[l][n]+y[l][o])/4,y[c][d]+=r*(2*Math.random()-1);for(p=0;p<2*e+1;p++){c=m*p;for(M=0;M<2*e+1;M++)if(d=a*M+m*(1-p%2),c<t&&0<c&&d<t&&0<d){for(var I=f=g=0;I<s.length;I++)u=s[I][0],h=d+s[I][1]*m,(v=c+u*m)<t&&0<v&&h<t&&0<h&&(g+=y[v][h],f+=1);y[c][d]+=g/f+r*(2*Math.random()-1)}}a=m,e*=2,r/=2}for(p=0;p<t;p++)for(M=0;M<t;M++)y[p][M]=(y[p][M]+1)/2,y[p][M]<0&&(y[p][M]=0),1<y[p][M]&&(y[p][M]=1);return y}function r(t){for(var a,e,r=document.querySelector("#myCanvas"),n=r.getContext("2d"),o=n.getImageData(0,0,t.length,t.length),i=(a=f.value,(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null),l=0;l<t.length;l++)for(var c=0;c<t.length;c++){var d=4*(l+c*t.length);o.data[d+0]=i.r*t[l][c],o.data[d+1]=i.g*t[l][c],o.data[d+2]=i.b*t[l][c],o.data[d+3]=255*t[l][c]}n.canvas.width=t.length,n.canvas.height=t.length,n.putImageData(o,0,0);var g=function(t,a){var e,r=t.getContext("2d"),n=t.width,o=t.height;if(a){e=r.getImageData(0,0,n,o);var i=r.globalCompositeOperation;r.globalCompositeOperation="destination-over",r.fillStyle=a,r.fillRect(0,0,n,o)}var l=t.toDataURL("image/jpeg");a&&(r.clearRect(0,0,n,o),r.putImageData(e,0,0),r.globalCompositeOperation=i);return l}(r,u.value);document.querySelector("#divImg").innerHTML="<img src='"+g+"'>"}f.addEventListener("change",function(){y||(y=e(t)),r(y)}),u.addEventListener("change",function(){y||(y=e(t)),r(y)}),a.addEventListener("click",function(){r(y=e(t))})}();