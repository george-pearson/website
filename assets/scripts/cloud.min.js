"use strict";!function(){var y,t=Math.pow(2,9)+1,d=document.querySelector("#color1"),u=document.querySelector("#color2"),a=document.querySelector("#reload");function e(t){(y=function(t,a){for(var e=[],r=0;r<t;r++)e[r]=[];for(r=0;r<t;r++)for(var n=0;n<a;n++)e[r][n]=0;return e}(t,t))[0][0]=2*Math.random()-1,y[0][t-1]=2*Math.random()-1,y[t-1][0]=2*Math.random()-1,y[t-1][t-1]=2*Math.random()-1;for(var a=t-1,e=1,r=1;1<a;){for(var n,o,i,c,l,d,u,f,g,v,h,m=Math.round(a/2),s=[[-1,0],[1,0],[0,-1],[0,1]],p=0;p<e;p++)for(var M=0;M<e;M++)o=(p+1)*a,c=(M+1)*a,d=(i=M*a)+m,y[l=(n=p*a)+m][d]=(y[i][n]+y[i][o]+y[c][n]+y[c][o])/4,y[l][d]+=r*(2*Math.random()-1);for(p=0;p<2*e+1;p++){l=m*p;for(M=0;M<2*e+1;M++)if(d=a*M+m*(1-p%2),l<t&&0<l&&d<t&&0<d){for(var I=f=u=0;I<s.length;I++)g=s[I][0],h=d+s[I][1]*m,(v=l+g*m)<t&&0<v&&h<t&&0<h&&(u+=y[v][h],f+=1);y[l][d]+=u/f+r*(2*Math.random()-1)}}a=m,e*=2,r/=2}for(p=0;p<t;p++)for(M=0;M<t;M++)y[p][M]=(y[p][M]+1)/2,y[p][M]<0&&(y[p][M]=0),1<y[p][M]&&(y[p][M]=1);return y}function r(t){for(var a=document.querySelector("#myCanvas"),e=a.getContext("2d"),r=e.getImageData(0,0,t.length,t.length),n=function(t){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}(d.value),o=0;o<t.length;o++)for(var i=0;i<t.length;i++){var c=4*(o+i*t.length);r.data[0+c]=n.r*t[o][i],r.data[1+c]=n.g*t[o][i],r.data[2+c]=n.b*t[o][i],r.data[3+c]=255*t[o][i]}e.canvas.width=t.length,e.canvas.height=t.length,e.putImageData(r,0,0);var l=function(t,a){var e,r=t.getContext("2d"),n=t.width,o=t.height;if(a){e=r.getImageData(0,0,n,o);var i=r.globalCompositeOperation;r.globalCompositeOperation="destination-over",r.fillStyle=a,r.fillRect(0,0,n,o)}var c=t.toDataURL("image/jpeg");a&&(r.clearRect(0,0,n,o),r.putImageData(e,0,0),r.globalCompositeOperation=i);return c}(a,u.value);document.querySelector("#divImg").innerHTML="<img src='"+l+"'>"}d.addEventListener("change",function(){y||(y=e(t)),r(y)}),u.addEventListener("change",function(){y||(y=e(t)),r(y)}),a.addEventListener("click",function(){r(y=e(t))})}();