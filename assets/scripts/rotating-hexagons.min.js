"use strict";

(function () {
  /*-------------------------------------------------------*\
  The "unit cell" consists of the arrangement of lines: \ /
                                                         |
  centred at the vertex where they meet.
  \*-------------------------------------------------------*/
  var width = 600; // image width.

  var height = 400; // image height.

  var cx = width / 2; // image center.

  var cy = height / 2; // image center.

  var a = 5; // line length.

  var gx = a * Math.sqrt(3) * 0.5; // a.sin(60).

  var gy = a * 0.5; // a.cos(60).

  var nx = Math.round(width / (gx * 2)) + 1; // Number of unit cells vertically.

  var ny = Math.round(height / (a + gy)) + 1; // Number of unit cells horizontally.

  var div = document.querySelector("#myDiv");
  var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  svg.setAttribute("width", width);
  svg.setAttribute("height", height);
  var group = document.createElementNS("http://www.w3.org/2000/svg", "g");
  group.setAttribute("style", "stroke: red;");
  var xoffset = 0;

  for (var iy = 0; iy < ny; iy++) {
    xoffset = xoffset == 0 ? gx : 0;

    for (var ix = 0; ix < nx; ix++) {
      add_unit_cell(group, ix * 2 * gx + xoffset, iy * (a + gy));
    }
  }

  svg.append(group);
  var group2 = group.cloneNode(true);
  group2.setAttribute("transform", "rotate(".concat(45, ", ", cx, ", ").concat(cy, ")"));
  group.setAttribute("style", "stroke: blue;");
  svg.append(group2);
  div.appendChild(svg);

  function add_unit_cell(svg, x, y) {
    add_line(svg, x, y, x, y + a);
    add_line(svg, x, y, x - gx, y - gy);
    add_line(svg, x, y, x + gx, y - gy);
  }

  function add_line(svg, x1, y1, x2, y2) {
    var newLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    newLine.setAttribute('x1', x1);
    newLine.setAttribute('y1', y1);
    newLine.setAttribute('x2', x2);
    newLine.setAttribute('y2', y2);
    svg.append(newLine);
  }
})();