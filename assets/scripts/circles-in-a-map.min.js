"use strict";!function(){var e=document.querySelector("#fig-circles"),l=document.querySelector("#uk_and_ireland"),t=document.querySelector("#uk_and_ireland_circles"),r=e.querySelector("canvas"),a=e.querySelector("button"),c=r.getContext("2d"),d=l.width,u=l.height;r.width=d,r.height=u;var o=document.querySelector("#colour1"),s=document.querySelector("#colour2"),m=document.querySelector("#colour3"),v=document.querySelector("#colour4"),b=e.querySelector("#rmin"),n=e.querySelector("#rminValueDisplay");n.innerHTML=b.value,b.addEventListener("change",function(e){n.innerHTML=b.value});var g=e.querySelector("#rmax"),i=e.querySelector("#rmaxValueDisplay");function y(e){var t=function(e,t,r){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",t),a.setAttribute("height",r);for(var n=0;n<e.length;n++){var i=document.createElementNS(a.namespaceURI,"circle");i.setAttribute("cx",e[n].cx),i.setAttribute("cy",e[n].cy),i.setAttribute("r",e[n].r),i.setAttribute("fill",e[n].colour),a.appendChild(i)}return a}(e.data[0],d,u);c.clearRect(0,0,d,u);var r=(new XMLSerializer).serializeToString(t),a=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(a),i=new Image;i.onload=function(){c.drawImage(i,0,0),URL.revokeObjectURL(n),L(!0)},i.src=n}function L(e){e?(a.innerHTML="Run",a.disabled=!1,b.disabled=!1,g.disabled=!1,o.disabled=!1,s.disabled=!1,m.disabled=!1,v.disabled=!1):(a.innerHTML="Working on it...",a.disabled=!0,b.disabled=!0,g.disabled=!0,o.disabled=!0,s.disabled=!0,m.disabled=!0,v.disabled=!0,t.style.display="none",r.style.display="block")}i.innerHTML=g.value,g.addEventListener("change",function(e){i.innerHTML=g.value}),c.drawImage(l,0,0),a.addEventListener("click",function(){L(!1),c.drawImage(l,0,0);var e=c.getImageData(0,0,d,u).data,t=[o.value,s.value,m.value,v.value],r=parseFloat(b.value),a=parseFloat(g.value),n=new Worker("/assets/scripts/circles-in-a-map.worker.min.js");n.addEventListener("message",y,!1);var i={imageData:e,circleColours:t,rmin:r,rmax:a,n:3e3,LX:d,LY:u};n.postMessage([i])})}();