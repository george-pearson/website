"use strict";!function(){var l=document.querySelector("#uk_and_ireland"),e=document.querySelector("#myCanvas"),t=document.querySelector("#btnRun"),u=e.getContext("2d"),d=Math.round(.6*l.naturalWidth),c=Math.round(.6*l.naturalHeight);e.width=d,e.height=c;var o=document.querySelector("#colour1"),s=document.querySelector("#colour2"),m=document.querySelector("#colour3"),v=document.querySelector("#colour4"),b=document.querySelector("#rmin"),r=document.querySelector("#rminValueDisplay");r.innerHTML=b.value,b.addEventListener("change",function(e){r.innerHTML=b.value});var g=document.querySelector("#rmax"),a=document.querySelector("#rmaxValueDisplay");function y(e){var t=function(e,t,r){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",t),a.setAttribute("height",r);for(var n=0;n<e.length;n++){var i=document.createElementNS(a.namespaceURI,"circle");i.setAttribute("cx",e[n].cx),i.setAttribute("cy",e[n].cy),i.setAttribute("r",e[n].r),i.setAttribute("fill",e[n].colour),a.appendChild(i)}return a}(e.data[0],d,c);u.clearRect(0,0,d,c);var r=(new XMLSerializer).serializeToString(t),a=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(a),i=new Image;i.onload=function(){u.drawImage(i,0,0),URL.revokeObjectURL(n),L(!0)},i.src=n}function L(e){e?(t.innerHTML="Run",t.disabled=!1,b.disabled=!1,g.disabled=!1,o.disabled=!1,s.disabled=!1,m.disabled=!1,v.disabled=!1):(t.innerHTML="Working on it...",t.disabled=!0,b.disabled=!0,g.disabled=!0,o.disabled=!0,s.disabled=!0,m.disabled=!0,v.disabled=!0)}a.innerHTML=g.value,g.addEventListener("change",function(e){a.innerHTML=g.value}),u.drawImage(l,0,0,d,c),t.addEventListener("click",function(){L(!1),u.drawImage(l,0,0,d,c);var e=u.getImageData(0,0,d,c).data,t=[o.value,s.value,m.value,v.value],r=parseFloat(b.value),a=parseFloat(g.value),n=new Worker("/assets/scripts/circles-in-a-map.worker.min.js");n.addEventListener("message",y,!1);var i={imageData:e,circleColours:t,rmin:r,rmax:a,n:1e3,LX:d,LY:c};n.postMessage([i])})}();